Metadata-Version: 1.2
Name: frog
Version: 1.2.1
Summary: Measurement archive utility daemon.
Home-page: https://sbtinstruments.com
Author: Timon Viola
Author-email: tvi@sbtinstruments.com
License: Proprietary
Description: # Frog service
        *Pre-SQLite era*
        
        The frog (Formatted Resource Output Generator) service implements the following functionality
        * mounting the device on PC connection
        * automatic report summary file generation on PC connection
        
        ## Report summary generation
        
        The measurement_summary.csv file is generated by first looping through all the .json files and then writing all the data into a summary file. The following columns are implemented in the report:
        
        |Time and date of measurement | Measurement ID | bacteria concentration |
        |-----------------------------|----------------|----------------|
        | MS Excel compatible format  | Unique ID | Measurement data|
        |`['status']['startedAt']`|`['id']`|`['analysis']['concentration']['sampleVolume']['bacteria']`|
        
        
        ### Further constraints
        
        * Cancelled or failed measurements are excluded from the summary
        
        As of now the cancelled or failed state is detected from the elapsed measurement time.
        
        ## Implementation
        The summary dump is currently implemented in the main loop of the service.
        
        The main loop runs once in every second and monitors the current state of the USB Device Controller (UDC) by reading `/sys/class/udc/ci_hdrc.0/state`.
        
        There are several states of the UDC according to the documentation. In sbtos the `configured` state indicates that the USB gadget is connected.
        
        When the loop detectes that the current state is `configured` but the previous state is not, the automatic report generation takes place as the following:
        1. USB gadget is removed
            * The UDC disabled in the firmware
        2. The storage is mounted to the SBT device
        3. The summary file is written on storage
        4. The storage is unmounted from the SBT device
        5. USB gadget is (re-)added
            * Re-enabling UDC
        
        `1.` and `5.` are neccessary so the desktop device will detect the freshly generated .csv summary file. This is implemented as:
        
        * UDC disable `echo "" > UDC` and 
        
        * UDC enable `echo "ci_hdrc.0" > UDC` .
        
        ## Measurement data management
        
        
        Past 6 months of data included in the summary report by default
        
        ## Future work
        - This service will require a rewrite after a SQLite data storage is implemented.
        
        - The user should not be able to execute a measurement while the SBT device is connected to a desktop device.
        
        - It might be interesting to use a python wrapper around USBG modifications  such as `gadgetconfig`
Keywords: iot sbt daemon
Platform: UNKNOWN
Classifier: Development Status :: 4 - Beta
Classifier: Topic :: Utilities
Classifier: License :: Other/Proprietary License
Requires-Python: >=3.8
