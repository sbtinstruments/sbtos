from contextlib import contextmanager
from rx import operators as ops, Observable
from rx.subject import AsyncSubject


@contextmanager
def until_context_ends(observable: Observable):
	done = AsyncSubject()
	yield observable.pipe(
		ops.take_until(done),
	)
	done.on_next(None)
	done.on_completed()


